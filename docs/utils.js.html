<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Utility Functions Module
 * Collection of reusable utility functions for common operations
 *
 * @author Seima Development Team
 * @version 1.0.0
 * @since 1.8.1
 */

/**
 * Utility class containing static methods for common operations
 * @class Utils
 */
export class Utils {

  /**
   * Dynamically load a JavaScript file
   * @static
   * @async
   * @param {string} src - URL of the script to load
   * @returns {Promise&lt;void>} Promise that resolves when script is loaded
   * @throws {Error} If script fails to load
   *
   * @example
   * ```javascript
   * await Utils.loadScript('https://cdn.example.com/library.js');
   * console.log('Script loaded successfully');
   * ```
   */
  static loadScript(src) {
    return new Promise((resolve, reject) => {
      // Check if script is already loaded
      if (document.querySelector(`script[src="${src}"]`)) {
        resolve();
        return;
      }

      const script = document.createElement('script');
      script.src = src;
      script.onload = resolve;
      script.onerror = () => reject(new Error(`Failed to load script: ${src}`));
      document.head.appendChild(script);
    });
  }

  /**
   * Load an image and return it when loaded
   * @static
   * @async
   * @param {string} src - Image URL to load
   * @returns {Promise&lt;HTMLImageElement>} Promise that resolves with loaded image
   * @throws {Error} If image fails to load
   *
   * @example
   * ```javascript
   * const img = await Utils.loadImage('/assets/product-image.jpg');
   * document.body.appendChild(img);
   * ```
   */
  static loadImage(src) {
    return new Promise((resolve, reject) => {
      const img = new Image();
      img.onload = () => resolve(img);
      img.onerror = () => reject(new Error(`Failed to load image: ${src}`));
      img.src = src;
    });
  }

  /**
   * Load image and convert to data URL (base64)
   * @static
   * @param {string} src - Image URL to load
   * @param {Function} callback - Callback function (dataURL, width, height)
   *
   * @example
   * ```javascript
   * Utils.loadImageAsDataURL('/assets/logo.png', (dataURL, width, height) => {
   *   if (dataURL) {
   *     console.log(`Image loaded: ${width}x${height}`);
   *   } else {
   *     console.error('Failed to load image');
   *   }
   * });
   * ```
   */
  static loadImageAsDataURL(src, callback) {
    const img = new Image();
    img.crossOrigin = 'anonymous';
    img.onload = function() {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = img.width;
      canvas.height = img.height;
      ctx.drawImage(img, 0, 0);
      try {
        const dataURL = canvas.toDataURL('image/png');
        callback(dataURL, img.width, img.height);
      } catch (e) {
        callback(null, 0, 0);
      }
    };
    img.onerror = () => callback(null, 0, 0);
    img.src = src;
  }

  /**
   * Format a numeric value as currency (Australian dollars)
   * @static
   * @param {string|number} price - Price value to format
   * @returns {string} Formatted price string (e.g., "$123.45") or empty string if invalid
   *
   * @example
   * ```javascript
   * Utils.formatPrice(123.456);     // "$123.46"
   * Utils.formatPrice("123.45");    // "$123.45"
   * Utils.formatPrice("invalid");   // ""
   * Utils.formatPrice(null);        // ""
   * ```
   */
  static formatPrice(price) {
    if (!price || price === '') {return '';}
    const numPrice = parseFloat(price.toString().replace(/[^\d.-]/g, ''));
    return isNaN(numPrice) ? '' : `$${numPrice.toFixed(2)}`;
  }

  /**
   * Sanitise user input by trimming and optionally limiting length
   * @static
   * @param {string} input - Input string to sanitise
   * @param {number|null} [maxLength=null] - Maximum allowed length
   * @returns {string} Sanitised string
   *
   * @example
   * ```javascript
   * Utils.sanitizeInput("  hello world  ");        // "hello world"
   * Utils.sanitizeInput("long text here", 8);      // "long tex"
   * Utils.sanitizeInput(123);                      // "" (non-string)
   * ```
   */
  static sanitizeInput(input, maxLength = null) {
    if (typeof input !== 'string') {return '';}
    let sanitized = input.trim();
    if (maxLength &amp;&amp; sanitized.length > maxLength) {
      sanitized = sanitized.substring(0, maxLength);
    }
    return sanitized;
  }

  /**
   * Create a debounced version of a function that delays execution
   * @static
   * @param {Function} func - Function to debounce
   * @param {number} delay - Delay in milliseconds
   * @returns {Function} Debounced function
   *
   * @example
   * ```javascript
   * const debouncedSearch = Utils.debounce((query) => {
   *   console.log('Searching for:', query);
   * }, 300);
   *
   * debouncedSearch('a');    // Won't execute immediately
   * debouncedSearch('ab');   // Cancels previous, won't execute immediately
   * debouncedSearch('abc');  // Will execute after 300ms
   * ```
   */
  static debounce(func, delay) {
    let timeoutId;
    return function (...args) {
      clearTimeout(timeoutId);
      timeoutId = setTimeout(() => func.apply(this, args), delay);
    };
  }

  /**
   * Generate a unique identifier string
   * @static
   * @returns {string} Unique ID combining timestamp and random string
   *
   * @example
   * ```javascript
   * const id1 = Utils.generateId(); // "l8k9j2h3_abc123def"
   * const id2 = Utils.generateId(); // "l8k9j2h4_xyz789ghi"
   * ```
   */
  static generateId() {
    return Date.now().toString(36) + Math.random().toString(36).substr(2);
  }

  /**
   * Create a deep clone of an object using JSON serialisation
   * Note: This method won't clone functions, undefined values, or circular references
   * @static
   * @param {Object} obj - Object to clone
   * @returns {Object} Deep clone of the object
   *
   * @example
   * ```javascript
   * const original = { user: { name: 'John', age: 30 } };
   * const clone = Utils.deepClone(original);
   * clone.user.name = 'Jane';
   * console.log(original.user.name); // Still "John"
   * ```
   */
  static deepClone(obj) {
    return JSON.parse(JSON.stringify(obj));
  }

  /**
   * Safely retrieve and parse a localStorage item
   * @static
   * @param {string} key - localStorage key
   * @param {*} [defaultValue=null] - Default value if key doesn't exist or parsing fails
   * @returns {*} Parsed value or default value
   *
   * @example
   * ```javascript
   * Utils.setStorageItem('settings', { theme: 'dark' });
   * const settings = Utils.getStorageItem('settings', {});
   * const missing = Utils.getStorageItem('nonexistent', 'default');
   * ```
   */
  static getStorageItem(key, defaultValue = null) {
    try {
      const item = localStorage.getItem(key);
      return item ? JSON.parse(item) : defaultValue;
    } catch (e) {
      console.warn(`Failed to parse localStorage item: ${key}`, e);
      return defaultValue;
    }
  }

  /**
   * Safely stringify and store a value in localStorage
   * @static
   * @param {string} key - localStorage key
   * @param {*} value - Value to store (will be JSON stringified)
   * @returns {boolean} True if successful, false otherwise
   *
   * @example
   * ```javascript
   * const success = Utils.setStorageItem('user', { name: 'John', id: 123 });
   * if (success) {
   *   console.log('User data saved');
   * }
   * ```
   */
  static setStorageItem(key, value) {
    try {
      localStorage.setItem(key, JSON.stringify(value));
      return true;
    } catch (e) {
      console.warn(`Failed to set localStorage item: ${key}`, e);
      return false;
    }
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BrowserCompatibilityManager.html">BrowserCompatibilityManager</a></li><li><a href="ConfigManager.html">ConfigManager</a></li><li><a href="ErrorHandler.html">ErrorHandler</a></li><li><a href="ProductGridManager.html">ProductGridManager</a></li><li><a href="SeimaScanner.html">SeimaScanner</a></li><li><a href="StorageManager.html">StorageManager</a></li><li><a href="Utils.html">Utils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CONFIG_SCHEMA">CONFIG_SCHEMA</a></li><li><a href="global.html#Environment">Environment</a></li><li><a href="global.html#ErrorCategory">ErrorCategory</a></li><li><a href="global.html#LogLevel">LogLevel</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat Aug 16 2025 02:34:06 GMT+0930 (Australian Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
